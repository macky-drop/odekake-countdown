---
// src/components/RouteCard.astro
import type { Route } from '../types/route';

interface Props {
  route: Route;
}

const { route } = Astro.props;

const priorityLabel = {
  'fastest': 'æœ€é€Ÿ',
  'cheapest': 'æœ€å®‰',
  'fewest-transfers': 'ä¹—æ›å°‘'
};

const getPriorityColor = (priority: Route['priority']) => {
  switch (priority) {
    case 'fastest': return '#4CAF50';
    case 'cheapest': return '#2196F3';
    case 'fewest-transfers': return '#FF9800';
    default: return '#757575';
  }
};
---

<div class="route-card">
  <div class="route-header">
    <span class="priority-badge" style={`background-color: ${getPriorityColor(route.priority)}`}>
      {priorityLabel[route.priority]}
    </span>
    <div class="route-info">
      <span class="duration">{route.totalDuration}åˆ†</span>
      <span class="cost">Â¥{route.totalCost}</span>
      <span class="transfers">ä¹—æ›{route.transferCount}å›</span>
    </div>
  </div>

  <div class="route-segments">
    {route.segments.map((segment, index) => (
      <div class="segment">
        {segment.type === 'walk' ? (
          <div class="segment-walk">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
            </svg>
            <span>å¾’æ­© {segment.duration}åˆ†</span>
            <span class="location">{segment.from} â†’ {segment.to}</span>
          </div>
        ) : (
          <div class="segment-transit">
            <div class="transit-line">
              <div class="line-icon" style={`background-color: ${segment.type === 'train' ? '#4CAF50' : '#2196F3'}`}>
                {segment.type === 'train' ? 'ğŸšƒ' : 'ğŸšŒ'}
              </div>
              <div class="line-info">
                <div class="line-name">{segment.line}</div>
                <div class="stations">{segment.from} â†’ {segment.to}</div>
              </div>
            </div>
            <div class="transit-time">
              <span class="time">{segment.departure}</span>
              <span class="arrow">â†’</span>
              <span class="time">{segment.arrival}</span>
              <span class="duration-small">({segment.duration}åˆ†)</span>
            </div>
          </div>
        )}
      </div>
    ))}
  </div>

  <button class="select-btn" data-route-id={route.id}>
    ã“ã®ãƒ«ãƒ¼ãƒˆã‚’é¸æŠ
  </button>
</div>

<style>
  .route-card {
    background: var(--surface);
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    margin-bottom: 16px;
  }

  .route-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }

  .priority-badge {
    color: white;
    padding: 4px 12px;
    border-radius: 16px;
    font-size: 12px;
    font-weight: 600;
  }

  .route-info {
    display: flex;
    gap: 12px;
    font-size: 14px;
    color: var(--text-secondary);
  }

  .duration {
    font-weight: 600;
    color: var(--text-primary);
  }

  .route-segments {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 16px;
  }

  .segment {
    padding-left: 8px;
    border-left: 2px solid var(--border);
  }

  .segment-walk {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: var(--text-secondary);
  }

  .location {
    font-size: 12px;
    color: var(--text-secondary);
  }

  .segment-transit {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .transit-line {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .line-icon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
  }

  .line-info {
    flex: 1;
  }

  .line-name {
    font-weight: 600;
    font-size: 14px;
    margin-bottom: 2px;
  }

  .stations {
    font-size: 13px;
    color: var(--text-secondary);
  }

  .transit-time {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    padding-left: 52px;
    color: var(--text-secondary);
  }

  .time {
    font-weight: 600;
    color: var(--text-primary);
  }

  .arrow {
    color: var(--text-secondary);
  }

  .duration-small {
    font-size: 12px;
  }

  .select-btn {
    width: 100%;
    padding: 12px;
    background-color: var(--primary);
    color: white;
    border-radius: 8px;
    font-weight: 600;
    transition: background-color 0.2s;
  }

  .select-btn:hover {
    background-color: var(--primary-dark);
  }
</style>
